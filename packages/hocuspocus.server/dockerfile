# Dockerfile

FROM node:alpine3.10

ARG ENVIRONMENT

ENV NODE_ENV=production

WORKDIR /app

# Print the value of the ENVIRONMENT variable
RUN echo "Environment is set to: ${ENVIRONMENT}"

COPY package*.json ./
COPY prisma ./prisma/
COPY .env ./

RUN npm install pm2 -g
RUN npm install --production
RUN npx prisma generate

COPY . .

CMD pm2-runtime pm2.config.cjs --only ${ENVIRONMENT}_rest,${ENVIRONMENT}_ws

