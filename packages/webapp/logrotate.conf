# Log rotation configuration for docsy webapp
# Place this file in /etc/logrotate.d/ or configure manually

~/.pm2/logs/docsy-webapp-*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    sharedscripts
    postrotate
        # Signal PM2 to reopen log files
        pm2 reloadLogs > /dev/null 2>&1 || true
    endscript
    # Set appropriate ownership and permissions for PM2 logs
    create 0644 $(whoami) $(whoami)
    # Use user's home directory for PM2 logs
    su $(whoami) $(whoami)
    # Maximum log file size before rotation
    size 100M
    # Don't rotate if log file is empty
    notifempty
    # Copy then truncate instead of moving (better for PM2)
    copytruncate
}
